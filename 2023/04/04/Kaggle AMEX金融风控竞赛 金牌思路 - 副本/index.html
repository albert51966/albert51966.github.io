<!DOCTYPE html>
<html lang=zh-CN>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="å«è±ªæ‰çš„åšå®¢">
    <meta property="og:type" content="website">
    <meta name="description" content="å«è±ªæ‰çš„åšå®¢">
    <meta name="keyword"  content="å«è±ªæ‰,å«è±ªæ‰çš„åšå®¢,æ—¥å¸¸åˆ†äº«,æŠ€æœ¯æ€»ç»“">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        CCF BDCI2023 è¿”ä¹¡å‘å±•äººç¾¤é¢„æµ‹ ç¬¬ä¸€åæ€è·¯ - Albert æ—¥å¸¸
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>

    









<meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Albert æ—¥å¸¸" type="application/atom+xml">
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> sometimes study, sometimes code </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/img/avatar.jpg" />
        </div>
        <div class="name">
            <i>Haocai Wei</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>ä¸»é¡µ</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li >
                <a href="/archive">
                    <i class="iconfont icon-guidang2"></i>
                    <span>å­˜æ¡£</span>
                </a>
            </li>
            <li >
                <a href="/collect/">
                    <i class="iconfont icon-shoucang1"></i>
                    <span>æ”¶è—</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>å…³äº</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>æœç´¢</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%BC%80%E5%A4%B4"><span class="toc-text">å†™åœ¨å¼€å¤´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%9B%E9%A2%98%E4%BB%BB%E5%8A%A1"><span class="toc-text">èµ›é¢˜ä»»åŠ¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87"><span class="toc-text">è¯„ä»·æŒ‡æ ‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D"><span class="toc-text">æ•°æ®ä»‹ç»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-text">æ•°æ®åˆ†æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%A6%81%E7%82%B9"><span class="toc-text">è§£é¢˜è¦ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8E%8B%E7%BC%A9%E6%96%B9%E6%B3%95"><span class="toc-text">æ•°æ®å‹ç¼©æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%91%E6%A8%A1%E5%9E%8B%E6%A8%A1%E5%9E%8B"><span class="toc-text">æ ‘æ¨¡å‹æ¨¡å‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B%E5%8F%82%E6%95%B0"><span class="toc-text">å®šä¹‰æ¨¡å‹å‚æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E5%A4%9A%E6%8A%98%E4%BA%A4%E5%8F%89%E8%AE%AD%E7%BB%83"><span class="toc-text">æ¨¡å‹å¤šæŠ˜äº¤å‰è®­ç»ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B"><span class="toc-text">æ·±åº¦å­¦ä¹ æ¨¡å‹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B"><span class="toc-text">ç‰¹å¾å·¥ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#meta-features%EF%BC%88%E6%9C%80%E9%87%8D%E8%A6%81%E7%9A%84%E7%89%B9%E5%BE%81%EF%BC%81%EF%BC%89"><span class="toc-text">meta featuresï¼ˆæœ€é‡è¦çš„ç‰¹å¾ï¼ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E%E6%B2%A1%E6%9C%89meta-features%E7%9A%84%E6%A8%A1%E5%9E%8B"><span class="toc-text">å¯¹äºæ²¡æœ‰meta featuresçš„æ¨¡å‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E6%96%B9%E6%B3%95%EF%BC%88meta-aggs%EF%BC%89%EF%BC%9A"><span class="toc-text">æ··åˆæ–¹æ³•ï¼ˆmeta+aggsï¼‰ï¼š</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Model"><span class="toc-text">Model</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%9E%8D%E5%90%88%E6%8A%80%E5%B7%A7"><span class="toc-text">æ¨¡å‹èåˆæŠ€å·§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8%E6%88%96%E6%B2%A1%E6%9C%89%E7%94%A8%EF%BC%9F"><span class="toc-text">ä»€ä¹ˆä¸èµ·ä½œç”¨æˆ–æ²¡æœ‰ç”¨ï¼Ÿ</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-bg" id="search-bg"></div>
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">æœç´¢</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> sometimes study, sometimes code </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        CCF BDCI2023 è¿”ä¹¡å‘å±•äººç¾¤é¢„æµ‹ ç¬¬ä¸€åæ€è·¯
    </div>

    <div class="post-meta">
        <span class="attr">å‘å¸ƒäºï¼š<span>2023-04-04 09:27:05</span></span>
        
        <span class="attr">æ ‡ç­¾ï¼š/
        
        <a class="tag" href="/tags/#BDCI" title="BDCI">BDCI</a>
        <span>/</span>
        
        <a class="tag" href="/tags/#AIç«èµ›" title="AIç«èµ›">AIç«èµ›</a>
        <span>/</span>
        
        <a class="tag" href="/tags/#ç»“æ„åŒ–" title="ç»“æ„åŒ–">ç»“æ„åŒ–</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">è®¿é—®ï¼š<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content no-indent">
        <h2 id="å†™åœ¨å¼€å¤´"><a href="#å†™åœ¨å¼€å¤´" class="headerlink" title="å†™åœ¨å¼€å¤´"></a>å†™åœ¨å¼€å¤´</h2><p>æœ¬æ¬¡æ¯”èµ›æ˜¯ä¸­å›½è®¡ç®—æœºå­¦ä¼šä¸¾åŠçš„ï¼Œ<strong>ç¬¬åå±Šå¤§æ•°æ®ä¸è®¡ç®—æ™ºèƒ½å¤§èµ›</strong>ä¸‹é¢å”¯äºŒçš„ä¸¤ä¸ªç»“æ„åŒ–èµ›é¢˜ï¼Œæœ€ç»ˆåæ¬¡æ˜¯<strong>ï¼ˆ1/2297)<strong>ã€‚è¯´å®è¯è¿™é“é¢˜å¯ä¾›æ€»ç»“å’Œå­¦ä¹ çš„åœ°æ–¹ä¸å¤šï¼Œæ•°æ®æ˜¯æ ‡å‡†çš„</strong>ç®€å•ç»“æ„åŒ–</strong>ç±»å‹ï¼Œä¸åŒ…å«ä»»ä½•æ—¶é—´ã€å¤šæ¨¡æ€ï¼ˆå›¾åƒã€æ–‡æœ¬ã€è¯­éŸ³ï¼‰ä¿¡æ¯éœ€è¦å¤„ç†ã€‚é‡ç‚¹æ˜¯å¦‚ä½•åšå¥½æ•°æ®æŒ–æ˜å·¥ä½œï¼ŒåŒ…æ‹¬<strong>é™¤å™ª</strong>ï¼ˆæœ€é‡è¦ï¼‰ï¼Œæ•°æ®åˆ†å¸ƒå·®å¼‚æ£€éªŒï¼Œæ— æ ‡ç­¾æ•°æ®çš„è®¤è¯†ï¼Œè®­ç»ƒé›†ã€æµ‹è¯•é›†Aã€æµ‹è¯•é›†Bæ•°æ®ç‰¹ç‚¹å’Œå·®å¼‚çš„æŒ–æ˜ç­‰ã€‚èµ›é¢˜æ•°æ®ç»è¿‡æ¨¡æ‹Ÿå’Œè„±æ•åä¸€è¨€éš¾å°½ï¼Œ<strong>çº¿ä¸Šçº¿ä¸‹ä¸ä¸€è‡´</strong>ï¼Œæœ¬åœ°CVä¸å¯ä¿¡ï¼Œæˆ‘çš„æ–¹æ³•ä¸»è¦å°±æ˜¯é ä¸æ–­æäº¤å»è¯•ï¼ˆä¸çŸ¥é“å¤§ä½¬æ€ä¹ˆå»åšï¼‰ï¼Œæˆ‘æœ€åæäº¤äº†166æ¬¡ï¼Œæœ€é«˜é˜Ÿä¼æˆ‘çœ‹æäº¤äº†å¿«200æ¬¡ã€‚ï¼ˆå¥–é‡‘è¿˜æ²¡æ”¶åˆ°ï¼Œä¸æ•¢å†å¾€ä¸‹è¯„ä»·èµ›é¢˜ï¼Œä»¥åæœ‰æœºä¼šç»†è¯´ï¼‰ï¼Œæ€»è€Œè¨€ä¹‹<strong>æ–°æ‰‹å¯ä»¥èŠ±ä¸¤åˆ†é’Ÿçœ‹ä¸€ä¸‹æ€è·¯ï¼Œä¸ç”¨è‡ªå·±å»è¯•ï¼Œå¯ä¾›å‚è€ƒçš„æ„ä¹‰ä¸å¤§</strong>ã€‚</p>
<h2 id="èµ›é¢˜ä»»åŠ¡"><a href="#èµ›é¢˜ä»»åŠ¡" class="headerlink" title="èµ›é¢˜ä»»åŠ¡"></a>èµ›é¢˜ä»»åŠ¡</h2><p>è¿‘å¹´æ¥ï¼Œä¸­å›½ç»æµé£é€Ÿå‘å±•ï¼Œå›½é™…åœ°ä½å’Œå›½é™…å½±å“åŠ›ä¸æ–­æé«˜ï¼Œç§‘æŠ€å‘å±•æ°´å¹³æ›´æ˜¯çªé£çŒ›è¿›ã€‚ä»¥åŒ—äº¬ã€ä¸Šæµ·ã€å¹¿å·ã€æ·±åœ³ç­‰åŸå¸‚ä¸ºé¦–çš„ä¸€çº¿å¤§åŸå¸‚ï¼Œæ›´æ˜¯å¸¦é¢†ç€æˆ‘å›½ç»æµç¨³æ­¥å‘å±•ã€‚ç„¶è€Œï¼Œéšç€ä¸€çº¿åŸå¸‚çš„ç”Ÿæ´»å‹åŠ›ä¸æ–­å¢å¤§ï¼Œè¶Šæ¥è¶Šå¤šçš„å¹´è½»äººé€‰æ‹©äº†è¿”å›å®¶ä¹¡å‘å±•ã€‚</p>
<p>åœ¨æœ¬æ¬¡æ¯”èµ›ä¸­ï¼Œæ‚¨å°†è¿ç”¨<strong>æœºå™¨å­¦ä¹ </strong>æŠ€èƒ½ï¼ŒåŸºäºä¸­å›½è”é€šçš„å¤§æ•°æ®èƒ½åŠ›ï¼Œé€šè¿‡ä½¿ç”¨å¯¹è”é€šçš„<strong>ä¿¡ä»¤æ•°æ®ã€é€šè¯æ•°æ®ã€äº’è”ç½‘è¡Œä¸º</strong>ç­‰æ•°æ®è¿›è¡Œå»ºæ¨¡ï¼Œå¯¹ä¸ªäººæ˜¯å¦ä¼š<strong>è¿”ä¹¡å·¥ä½œ</strong>è¿›è¡Œåˆ¤æ–­ã€‚</p>
<p>æ¯”èµ›é“¾æ¥ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.datafountain.cn/competitions/581">https://www.datafountain.cn/competitions/581</a></p>
<h2 id="è¯„ä»·æŒ‡æ ‡"><a href="#è¯„ä»·æŒ‡æ ‡" class="headerlink" title="è¯„ä»·æŒ‡æ ‡"></a>è¯„ä»·æŒ‡æ ‡</h2><p>æœ¬æ¬¡æ¯”èµ›ä½¿ç”¨ROCæ›²çº¿ä¸‹é¢ç§¯AUCï¼ˆArea Under Curveï¼‰ä½œä¸ºè¯„ä»·æŒ‡æ ‡ï¼ŒAUCè¶Šå¤§ï¼Œé¢„æµ‹è¶Šå‡†ç¡®ã€‚<img src="/img/bdci_auc.png" alt="img"></p>
<p>å…¶æœ¬è´¨æ˜¯é¢„æµ‹ç»“æœæ­£æ ·æœ¬æ’åœ¨è´Ÿæ ·æœ¬å‰é¢çš„æ¦‚ç‡ï¼Œåæ˜ çš„æ˜¯åˆ†ç±»å™¨å¯¹æ ·æœ¬çš„æ’åºèƒ½åŠ›ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¾“å‡ºçš„æ˜¯æ¦‚ç‡è€Œä¸æ˜¯01åˆ†ç±»ã€‚</p>
<h2 id="æ•°æ®ä»‹ç»"><a href="#æ•°æ®ä»‹ç»" class="headerlink" title="æ•°æ®ä»‹ç»"></a><strong>æ•°æ®ä»‹ç»</strong></h2><p>èµ›é¢˜çš„ç›®çš„æ˜¯åŸºäºä¸­å›½è”é€šçš„å¤§æ•°æ®èƒ½åŠ›ï¼Œé€šè¿‡ä½¿ç”¨å¯¹è”é€šçš„ä¿¡ä»¤ã€é€šè¯ã€äº’è”ç½‘è¡Œä¸ºç­‰æ•°æ®è¿›è¡Œå»ºæ¨¡ï¼Œé¢„æµ‹æ ·æœ¬è¿”å›å®¶ä¹¡å·¥ä½œå‘å±•çš„æ¦‚ç‡ã€‚ èµ›é¢˜æ•°æ®ç”±è”é€šåŸºç«™äº§ç”Ÿçš„ç”¨æˆ·ä¿¡ä»¤æ•°æ®ã€è”é€šç”¨æˆ·ä¸Šç½‘äº§ç”Ÿçš„ä¸Šç½‘è¡Œä¸ºæ•°æ®åŠç”¨æˆ·æ—¥å¸¸é€šè¯ã€çŸ­ä¿¡äº§ç”Ÿçš„æ•°æ®ï¼Œå¹¶<strong>é€šè¿‡äº†åŒ¿åå’Œæ¨¡æ‹Ÿå¤„ç†</strong>ï¼Œç‰¹å¾å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ç±»åˆ«ï¼š</p>
<p>æœ¬æ¬¡æ¯”èµ›çš„ç›®çš„æ˜¯æ ¹æ®å®¢æˆ·æ¯æœˆçš„å®¢æˆ·èµ„æ–™é¢„æµ‹å®¢æˆ·æœªæ¥ä¸å¿è¿˜ä¿¡ç”¨å¡ä½™é¢çš„æ¦‚ç‡ã€‚ç›®æ ‡äºŒå…ƒå˜é‡æ˜¯é€šè¿‡è§‚å¯Ÿæœ€è¿‘ä¸€æ¬¡ä¿¡ç”¨å¡è´¦å•å 18 ä¸ªæœˆçš„ç»©æ•ˆçª—å£æ¥è®¡ç®—çš„ï¼Œå¦‚æœå®¢æˆ·åœ¨æœ€è¿‘ä¸€æ¬¡è´¦å•æ—¥åçš„ 120 å¤©å†…æœªæ”¯ä»˜åˆ°æœŸé‡‘é¢ï¼Œåˆ™å°†å…¶è§†ä¸ºè¿çº¦äº‹ä»¶ã€‚</p>
<ul>
<li>ä½ç½®ç±»ç‰¹ç‰¹å¾</li>
<li>äº’è”ç½‘ç±»ç‰¹å¾</li>
<li>é€šè¯ç±»ç‰¹å¾</li>
</ul>
<p><strong>å…¶ä¸­è¿™äº›å˜é‡ä¸ºç±»åˆ«å˜é‡ï¼š</strong></p>
<p> [â€˜B_30â€™, â€˜B_38â€™, â€˜D_114â€™, â€˜D_116â€™, â€˜D_117â€™, â€˜D_120â€™, â€˜D_126â€™, â€˜D_63â€™, â€˜D_64â€™, â€˜D_66â€™, â€˜D_68â€™]</p>
<p>æ˜¯ä¸ºæ¯ä¸ªcustomer_IDé¢„æµ‹æœªæ¥ä»˜æ¬¾è¿çº¦çš„æ¦‚ç‡ï¼ˆç›®æ ‡ = 1ï¼‰ï¼Œæ¯ä¸ªæ–‡ä»¶å†…å®¹çš„ä»‹ç»å¦‚ä¸‹ï¼š</p>
<p>train_data.csv - æ¯ä¸ª customer_ID å…·æœ‰å¤šä¸ªæ—¥æœŸçš„è®­ç»ƒæ•°æ®</p>
<p>train_labels.csv - æ¯ä¸ª customer_ID çš„ç›®æ ‡æ ‡ç­¾</p>
<p>test_data.csv - å¯¹åº”çš„æµ‹è¯•æ•°æ®ï¼›æ‚¨çš„ç›®æ ‡æ˜¯é¢„æµ‹æ¯ä¸ª customer_ID çš„ç›®æ ‡æ ‡ç­¾</p>
<p>sample_submission.csv - æ ¼å¼æ­£ç¡®çš„ç¤ºä¾‹æäº¤æ–‡ä»¶</p>
<h2 id="æ•°æ®åˆ†æ"><a href="#æ•°æ®åˆ†æ" class="headerlink" title="æ•°æ®åˆ†æ"></a>æ•°æ®åˆ†æ</h2><p>é¦–å…ˆæˆ‘ä»¬æ¥æŸ¥çœ‹ä¸‹æ•°æ®é›†ï¼Œåœ¨æ•°æ®é›†ä¸­çš„æ•°æ®å­—æ®µåŸºæœ¬è¿›è¡Œäº†åŒ¿åå¤„ç†ï¼š</p>
<p><img src="/img/amex_shujuji1.png" alt="image-20230404005728070"></p>
<p>åœ¨æ•°æ®é›†ä¸­ä¹Ÿæœ‰è¾ƒå¤šçš„å­—æ®µåŒ…å«äº†ç¼ºå¤±å€¼ï¼š</p>
<p><img src="/img/amex_shujuji2.png" alt="image-20230404005839357"></p>
<p>æ¯”èµ›æ ‡ç­¾åˆ†å¸ƒä¸­è¿çº¦ç”¨æˆ·å æ¯”è¾ƒå°‘ï¼Œç±»åˆ«åˆ†å¸ƒæ¯”è¾ƒå‡è¡¡ï¼š</p>
<p><img src="/img/amex_shujuji3.png" alt="image-20230404011109833"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å­—æ®µæŒ‰ç…§åˆ†ç±»ä¹‹åçš„ç»Ÿè®¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/img/amex_shujuji4.png" alt="image-20230404011141158"></p>
<p>è¿›ä¸€æ­¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»Ÿè®¡å­—æ®µä¸æ ‡ç­¾çš„ç›¸å…³æ€§ï¼š</p>
<p><img src="/img/amex_shujuji5.png" alt="image-20230404011208752"></p>
<h2 id="è§£é¢˜è¦ç‚¹"><a href="#è§£é¢˜è¦ç‚¹" class="headerlink" title="è§£é¢˜è¦ç‚¹"></a><strong>è§£é¢˜è¦ç‚¹</strong></h2><h4 id="æ•°æ®å‹ç¼©æ–¹æ³•"><a href="#æ•°æ®å‹ç¼©æ–¹æ³•" class="headerlink" title="æ•°æ®å‹ç¼©æ–¹æ³•"></a><strong>æ•°æ®å‹ç¼©æ–¹æ³•</strong></h4><p>ç”±äºæ•°æ®é›†åŸå§‹æ•°æ®é›†æ–‡ä»¶è¾ƒå¤§ï¼ˆ50GBå·¦å³ï¼‰ï¼Œç›´æ¥è¿›è¡Œè¯»å–å¹¶è¿›è¡Œåˆ†æå¹¶ä¸å¯å–ã€‚åœ¨è¿›è¡Œé€å…¥æ¨¡å‹è¿›è¡Œä¹‹å‰å¯ä»¥è€ƒè™‘å¯¹æ•°æ®å€¼è¿›è¡Œå‹ç¼©ï¼Œå…·ä½“çš„å‹ç¼©æ–¹æ³•åŒ…æ‹¬ï¼š</p>
<p>â€¢å°†æ•°æ®é›†ä¸­çš„ç±»åˆ«å­—æ®µï¼Œä½¿ç”¨Pandasçš„categoryè¿›è¡Œä»£æ›¿ï¼›</p>
<p>â€¢å°†æ•°æ®é›†ä¸­çš„æ•°å€¼å­—æ®µï¼Œä½¿ç”¨flaoat16å’Œfloat32ä»£æ›¿åŸå§‹çš„float64ï¼›</p>
<p>â€¢å°†æ•°æ®é›†ä½¿ç”¨featheræˆ–è€…parquetæ ¼å¼è¿›è¡Œå­˜å‚¨ï¼›</p>
<p>é€šè¿‡ä¸Šè¿°æ–¹æ³•å¯ä»¥å°†æ•°æ®é›†å‹ç¼©åˆ°æ€»å…±5GBå·¦å³ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å°è¯•åç»­çš„å»ºæ¨¡è¿‡ç¨‹ã€‚</p>
<p><strong>æ•°æ®é›†å‹ç¼©å’Œè½¬æ¢çš„è¿‡ç¨‹å¯ä»¥å‚è€ƒï¼š</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.kaggle.com/code/abdellatifsassioui/create-pickeld-data-from-50-gb-to-6gb">https://www.kaggle.com/code/abdellatifsassioui/create-pickeld-data-from-50-gb-to-6gb</a></p>
<h4 id="æ ‘æ¨¡å‹æ¨¡å‹"><a href="#æ ‘æ¨¡å‹æ¨¡å‹" class="headerlink" title="æ ‘æ¨¡å‹æ¨¡å‹"></a><strong>æ ‘æ¨¡å‹æ¨¡å‹</strong></h4><p>æœ¬æ¬¡èµ›é¢˜æ˜¯ä¸€ä¸ªå…¸å‹çš„åŒ¿åç»“æ„åŒ–æ¯”èµ›ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘ç›´æ¥ä½¿ç”¨æ ‘æ¨¡å‹æ¥è¿›è¡Œå»ºæ¨¡ï¼Œå…·ä½“çš„æ­¥éª¤ä¸ºï¼š</p>
<p>â€¢å¯¹æ•°æ®é›†è¿›è¡Œå¤„ç†</p>
<p>â€¢å®šä¹‰æ ‘æ¨¡å‹è¿›è¡Œè®­ç»ƒ</p>
<p>â€¢äº”æŠ˜äº¤å‰å®Œæˆé¢„æµ‹</p>
<h4 id="å®šä¹‰æ¨¡å‹å‚æ•°"><a href="#å®šä¹‰æ¨¡å‹å‚æ•°" class="headerlink" title="å®šä¹‰æ¨¡å‹å‚æ•°"></a><strong>å®šä¹‰æ¨¡å‹å‚æ•°</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># XGB MODEL PARAMETERS </span></span><br><span class="line">xgb_parms = &#123;      </span><br><span class="line">	<span class="string">&#x27;max_depth&#x27;</span>:<span class="number">4</span>,      </span><br><span class="line">  <span class="string">&#x27;learning_rate&#x27;</span>:<span class="number">0.05</span>,      </span><br><span class="line">  <span class="string">&#x27;subsample&#x27;</span>:<span class="number">0.8</span>,     </span><br><span class="line">  <span class="string">&#x27;colsample_bytree&#x27;</span>:<span class="number">0.6</span>,      </span><br><span class="line">  <span class="string">&#x27;eval_metric&#x27;</span>:<span class="string">&#x27;logloss&#x27;</span>,     </span><br><span class="line">  <span class="string">&#x27;objective&#x27;</span>:<span class="string">&#x27;binary:logistic&#x27;</span>,     </span><br><span class="line">  <span class="string">&#x27;tree_method&#x27;</span>:<span class="string">&#x27;gpu_hist&#x27;</span>,     </span><br><span class="line">  <span class="string">&#x27;predictor&#x27;</span>:<span class="string">&#x27;gpu_predictor&#x27;</span>,     </span><br><span class="line">  <span class="string">&#x27;random_state&#x27;</span>:SEED </span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ¨¡å‹å¤šæŠ˜äº¤å‰è®­ç»ƒ"><a href="#æ¨¡å‹å¤šæŠ˜äº¤å‰è®­ç»ƒ" class="headerlink" title="æ¨¡å‹å¤šæŠ˜äº¤å‰è®­ç»ƒ"></a><strong>æ¨¡å‹å¤šæŠ˜äº¤å‰è®­ç»ƒ</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">skf = KFold(n_splits=FOLDS)</span><br><span class="line"> <span class="keyword">for</span> fold,(train_idx, valid_idx) <span class="keyword">in</span> <span class="built_in">enumerate</span>(skf.split(</span><br><span class="line">             train, train.target )):</span><br><span class="line">         </span><br><span class="line">     <span class="comment"># TRAIN, VALID, TEST FOR FOLD K</span></span><br><span class="line">     Xy_train = IterLoadForDMatrix(train.loc[train_idx], FEATURES, <span class="string">&#x27;target&#x27;</span>)</span><br><span class="line">     X_valid = train.loc[valid_idx, FEATURES]</span><br><span class="line">     y_valid = train.loc[valid_idx, <span class="string">&#x27;target&#x27;</span>]</span><br><span class="line">     </span><br><span class="line">     dtrain = xgb.DeviceQuantileDMatrix(Xy_train, max_bin=<span class="number">256</span>)</span><br><span class="line">     dvalid = xgb.DMatrix(data=X_valid, label=y_valid)</span><br><span class="line">     </span><br><span class="line">     <span class="comment"># TRAIN MODEL FOLD K</span></span><br><span class="line">     model = xgb.train(xgb_parms, </span><br><span class="line">                 dtrain=dtrain,</span><br><span class="line">                 evals=[(dtrain,<span class="string">&#x27;train&#x27;</span>),(dvalid,<span class="string">&#x27;valid&#x27;</span>)],</span><br><span class="line">                 num_boost_round=<span class="number">9999</span>,</span><br><span class="line">                 early_stopping_rounds=<span class="number">100</span>,</span><br><span class="line">                 verbose_eval=<span class="number">100</span>) </span><br><span class="line">     model.save_model(<span class="string">f&#x27;XGB_v<span class="subst">&#123;VER&#125;</span>_fold<span class="subst">&#123;fold&#125;</span>.xgb&#x27;</span>)</span><br><span class="line">     </span><br><span class="line">     <span class="comment"># GET FEATURE IMPORTANCE FOR FOLD K</span></span><br><span class="line">     dd = model.get_score(importance_type=<span class="string">&#x27;weight&#x27;</span>)</span><br><span class="line">     df = pd.DataFrame(&#123;<span class="string">&#x27;feature&#x27;</span>:dd.keys(),<span class="string">f&#x27;importance_<span class="subst">&#123;fold&#125;</span>&#x27;</span>:dd.values()&#125;)</span><br><span class="line">     importances.append(df)</span><br><span class="line">             </span><br><span class="line">     <span class="comment"># INFER OOF FOLD K</span></span><br><span class="line">     oof_preds = model.predict(dvalid)</span><br><span class="line">     acc = amex_metric_mod(y_valid.values, oof_preds)</span><br><span class="line">     <span class="built_in">print</span>(<span class="string">&#x27;Kaggle Metric =&#x27;</span>,acc,<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">     </span><br><span class="line">     <span class="comment"># SAVE OOF</span></span><br><span class="line">     df = train.loc[valid_idx, [<span class="string">&#x27;customer_ID&#x27;</span>,<span class="string">&#x27;target&#x27;</span>] ].copy()</span><br><span class="line">     df[<span class="string">&#x27;oof_pred&#x27;</span>] = oof_preds</span><br><span class="line">     oof.append( df )</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">del</span> dtrain, Xy_train, dd, df</span><br><span class="line">     <span class="keyword">del</span> X_valid, y_valid, dvalid, model</span><br><span class="line">     _ = gc.collect()</span><br></pre></td></tr></table></figure>

<h4 id="æ·±åº¦å­¦ä¹ æ¨¡å‹"><a href="#æ·±åº¦å­¦ä¹ æ¨¡å‹" class="headerlink" title="æ·±åº¦å­¦ä¹ æ¨¡å‹"></a><strong>æ·±åº¦å­¦ä¹ æ¨¡å‹</strong></h4><p>ç”±äºæœ¬æ¬¡æ¯”èµ›æ•°æ®é‡æ¯”è¾ƒå¤šï¼Œå› æ­¤æ·±åº¦å­¦ä¹ æ¨¡å‹ä¹Ÿå¯ä»¥è€ƒè™‘ã€‚æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸»è¦éœ€è¦è°ƒæ•´ç½‘ç»œç»“æ„ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåŸºç¡€çš„LSTMä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_model1</span>(<span class="params">n_inputs</span>):</span></span><br><span class="line">    </span><br><span class="line">    x_input = Input(shape=(n_inputs,))</span><br><span class="line">    </span><br><span class="line">    x1 = Bidirectional(LSTM(units=<span class="number">768</span>, return_sequences=<span class="literal">True</span>))(x_input)</span><br><span class="line">    x2 = Bidirectional(LSTM(units=<span class="number">512</span>, return_sequences=<span class="literal">True</span>))(x1)</span><br><span class="line">    x3 = Bidirectional(LSTM(units=<span class="number">384</span>, return_sequences=<span class="literal">True</span>))(x2)</span><br><span class="line">    x4 = Bidirectional(LSTM(units=<span class="number">256</span>, return_sequences=<span class="literal">True</span>))(x3)</span><br><span class="line">    x5 = Bidirectional(LSTM(units=<span class="number">128</span>, return_sequences=<span class="literal">True</span>))(x4)</span><br><span class="line">    </span><br><span class="line">    z2 = Bidirectional(GRU(units=<span class="number">384</span>, return_sequences=<span class="literal">True</span>))(x2)</span><br><span class="line">    </span><br><span class="line">    z31 = Multiply()([x3, z2])</span><br><span class="line">    z31 = BatchNormalization()(z31)</span><br><span class="line">    z3 = Bidirectional(GRU(units=<span class="number">256</span>, return_sequences=<span class="literal">True</span>))(z31)</span><br><span class="line">    </span><br><span class="line">    z41 = Multiply()([x4, z3])</span><br><span class="line">    z41 = BatchNormalization()(z41)</span><br><span class="line">    z4 = Bidirectional(GRU(units=<span class="number">128</span>, return_sequences=<span class="literal">True</span>))(z41)</span><br><span class="line">    </span><br><span class="line">    z51 = Multiply()([x5, z4])</span><br><span class="line">    z51 = BatchNormalization()(z51)</span><br><span class="line">    z5 = Bidirectional(GRU(units=<span class="number">64</span>, return_sequences=<span class="literal">True</span>))(z51)</span><br><span class="line">    </span><br><span class="line">    x = Concatenate(axis=<span class="number">2</span>)([x5, z2, z3, z4, z5])</span><br><span class="line">    </span><br><span class="line">    x = Dense(units=<span class="number">128</span>, activation=<span class="string">&#x27;selu&#x27;</span>)(x)</span><br><span class="line">    </span><br><span class="line">    x_output = Dense(units=<span class="number">1</span>)(x)</span><br><span class="line"></span><br><span class="line">    model = Model(inputs=x_input, outputs=x_output, </span><br><span class="line">                  name=<span class="string">&#x27;DNN_Model&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> model            </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ç‰¹å¾å·¥ç¨‹"><a href="#ç‰¹å¾å·¥ç¨‹" class="headerlink" title="ç‰¹å¾å·¥ç¨‹"></a>ç‰¹å¾å·¥ç¨‹</h2><h4 id="meta-featuresï¼ˆæœ€é‡è¦çš„ç‰¹å¾ï¼ï¼‰"><a href="#meta-featuresï¼ˆæœ€é‡è¦çš„ç‰¹å¾ï¼ï¼‰" class="headerlink" title="meta featuresï¼ˆæœ€é‡è¦çš„ç‰¹å¾ï¼ï¼‰"></a>meta featuresï¼ˆæœ€é‡è¦çš„ç‰¹å¾ï¼ï¼‰</h4><ul>
<li><p>æ€ä¹ˆåš</p>
<ol>
<li>train_labels åˆ†é…ç»™è®­ç»ƒæ•°æ®ï¼ˆåœ¨ cid èšåˆä¹‹å‰ï¼‰å’Œè®­ç»ƒæ¨¡å‹ã€‚</li>
<li>å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œ oof é¢„æµ‹ã€‚</li>
<li>æŒ‰æ—¶é—´æ®µèšåˆ oof é¢„æµ‹ã€‚</li>
</ol>
</li>
<li><p>å‚è€ƒ DSB2019 çš„ç¬¬ 2 ä½è§£å†³æ–¹æ³•ã€‚</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.kaggle.com/c/data-science-bowl-2019/discussion/127388">https://www.kaggle.com/c/data-science-bowl-2019/discussion/127388</a></li>
</ul>
</li>
<li><p>ä¸ºä»€ä¹ˆ<strong>meta features</strong>å¾ˆé‡è¦</p>
<ul>
<li><p>åœ¨å¤§å¤šæ•°å…¬å…±ç¬”è®°æœ¬ä¸­ï¼Œç‰¹å¾éƒ½æ˜¯åŸºäº agg æ–¹æ³•çš„ï¼Œä¾‹å¦‚ minã€maxã€mean å’Œ stdã€‚</p>
</li>
<li><p>å°½ç®¡è¿™äº› agg ç‰¹å¾å…·æœ‰è¡¨ç°åŠ›ï¼Œä½†åœ¨ 13 æ¡è¯­å¥è¢«å‹ç¼©ä¸ºæœ‰é™çš„ç»Ÿè®¡æ•°æ®æœŸé—´ï¼Œä¸€äº›ä¿¡æ¯æ­£åœ¨ä¸¢å¤±ã€‚</p>
</li>
<li><p>æˆ‘åªæ˜¯æƒ³<strong>å¦‚ä½•åˆ©ç”¨æ¯ä¸ªè¯­å¥çš„ä¿¡æ¯è€Œä¸æ˜¯èšåˆå®ƒä»¬ã€‚</strong></p>
</li>
<li><p>å°† [N_USER, 13, 188] ä¸­çš„æ•°æ®æ‰å¹³åŒ–ä¸º [N_USER, 13*188] æ˜¯ç›´æˆªäº†å½“çš„æ–¹æ³•ï¼Œä½†æˆ‘è§‰å¾—å®ƒä¼šå¢åŠ å¤ªå¤šçš„ç‰¹å¾æš—æ·¡ã€‚</p>
</li>
<li><p>ç„¶åæˆ‘æƒ³å‡ºäº†é¢„æµ‹æ¯æ¡è¯­å¥çš„é»˜è®¤åˆ†æ•°çš„æƒ³æ³•ï¼Œ<strong>å¯ä»¥çœ‹ä½œæ˜¯æ¯æ¡è¯­å¥çš„å‡å</strong>ã€‚</p>
</li>
<li><p>è¿™ 13 ä¸ªé¢„æµ‹åˆ†æ•°å°±æ˜¯æ‰€è°“çš„<strong>meta features</strong>ï¼Œåœ¨æ¨¡å‹ä¸­ç”¨ä½œæ¯ä¸ªå®¢æˆ·çš„æ•°å­—ç‰¹å¾ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 id="å¯¹äºæ²¡æœ‰meta-featuresçš„æ¨¡å‹"><a href="#å¯¹äºæ²¡æœ‰meta-featuresçš„æ¨¡å‹" class="headerlink" title="å¯¹äºæ²¡æœ‰meta featuresçš„æ¨¡å‹"></a>å¯¹äºæ²¡æœ‰meta featuresçš„æ¨¡å‹</h4><ul>
<li><p>åŸºæœ¬åŠŸèƒ½æ¥è‡ªå…¬å…±ç¬”è®°æœ¬</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.kaggle.com/code/thedevastator/amex-features-the-best-of-both-worlds">https://www.kaggle.com/code/thedevastator/amex-features-the-best-of-both-worlds</a></li>
</ul>
</li>
<li><p>æˆ‘ä»¬å¯¹åˆ†ç±»ï¼ˆnuniqueï¼Œcountï¼Œfirstï¼Œmeanï¼‰è¿›è¡Œäº†é€šå¸¸çš„èšåˆ<strong>stdï¼Œmeanï¼Œminï¼Œmax</strong>ã€‚æˆ‘ä»¬è¿˜å°è¯•äº† MADï¼ˆ<strong>Mean Absolute deviation</strong>ï¼‰ï¼Œå®ƒç¡®å®å¯¹æˆ‘ä»¬çš„ cv æœ‰æ‰€å¸®åŠ©ï¼Œä½†æ˜¯Public LB å¾—åˆ†ä¼šç¨å¾®ä¸‹é™ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰åœ¨æœ€ç»ˆprivateæäº¤ä¸­ä¸­åŒ…å«åŸºäº mad çš„æ¨¡å‹ï¼Œå°½ç®¡äº‹åçœ‹æ¥å®ƒå¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p>
</li>
<li><p>è¿˜æ·»åŠ äº†ç™¾åˆ†æ¯”å˜åŒ–åŠŸèƒ½ï¼Œè¡¨ç¤ºæ•°å­—ç‰¹å¾éšæ—¶é—´çš„ç™¾åˆ†æ¯”å˜åŒ–ï¼Œåœ¨ä¸€äº›æ¨¡å‹çš„å°è¯•ä¸­æ˜¾ç¤ºæ¯”ä»…ä½¿ç”¨<strong>numeric diff</strong>æ•ˆæœæ›´å¥½ã€‚</p>
</li>
<li><p>åœ¨æˆ‘ä»¬çš„å¤§å¤šæ•°ä¼˜ç§€æ¨¡å‹ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ€§æ˜¯ä¿ç•™ <strong>last, first</strong> å’Œ <strong>middle</strong>ï¼Œæ­£å¦‚æˆ‘ä»¬å‡è®¾çš„é‚£æ ·ï¼Œè¿™å°†æœ‰åŠ©äºæˆ‘ä»¬è¦†ç›–å®¢æˆ·çš„å¤§å¤šæ•°å˜åŒ–ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»èšåˆäº†ç‰¹å¾ã€‚</p>
</li>
<li><p>æˆ‘ä»¬å°è¯•çš„å¦ä¸€ä¸ªåŠŸèƒ½æ˜¯è®¡ç®—<strong>spend/balance</strong>æˆ–<strong>spend_sum/balance_sum</strong>æ¯”ç‡ï¼Œå®ƒåœ¨æŸäº›æ¨¡å‹ä¸­ç¡®å®æœ‰å¸®åŠ©ï¼Œä½†ä¸æ˜¯éƒ½æœ‰æ•ˆã€‚</p>
</li>
</ul>
<h4 id="æ··åˆæ–¹æ³•ï¼ˆmeta-aggsï¼‰ï¼š"><a href="#æ··åˆæ–¹æ³•ï¼ˆmeta-aggsï¼‰ï¼š" class="headerlink" title="æ··åˆæ–¹æ³•ï¼ˆmeta+aggsï¼‰ï¼š"></a>æ··åˆæ–¹æ³•ï¼ˆmeta+aggsï¼‰ï¼š</h4><p>æˆ‘ä»¬è¿˜å°è¯•äº†å°†æ‰å¹³åŒ–çš„<strong>meta features</strong>ä¸ <strong>aggregates</strong> æ··åˆåœ¨ä¸€èµ·ï¼Œè¿™ç¡®å®æœ‰åŠ©äºæˆ‘ä»¬çš„æ¨¡å‹ï¼Œç‰¹åˆ«æ˜¯LGBM CAT XGBå’ŒTabnetã€‚<br>ç”±äº<strong>meta features</strong>çš„å­˜åœ¨ï¼Œè¿™ç§æ–¹æ³•é€šå¸¸æ”¶æ•›å¾—æ›´å¿«ï¼ˆåœ¨XGBä¸­<strong>earlystop</strong>çš„è½®æ•°æ›´å°‘,å…¶ä»–ç‰¹å¾å­¦ä¹ çš„ä¸å……åˆ†ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸ä¸ºè¿™ç§æ–¹æ³•é™ä½LRï¼Œè®©æ¨¡å‹å­¦ä¹ æ…¢ä¸€ç‚¹ã€‚</p>
<h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><p>æ‰€æœ‰æ¨¡å‹éƒ½ä½¿ç”¨<strong>meta features</strong>å’Œ<strong>engineered aggregates</strong>è¿›è¡Œè®­ç»ƒã€‚NN æ¨¡å‹å¤§éƒ¨åˆ†éƒ½ç”¨ <strong>GaussianScalar</strong> è¿›è¡Œäº†ç¼©æ”¾</p>
<p><strong>LGBM (Max cv 0.79932 Private 0.80731) ï¼šä¸</strong>åŸºäº<a target="_blank" rel="noopener" href="https://www.kaggle.com/ragnar123">@ragnar123</a>å¼€æºçš„Notebookçš„å¤§å¤šæ•°æƒ…å†µä¸€æ ·ã€‚æˆ‘ä»¬ç¡®å®å¯¹è¶…å‚æ•°åšäº†ä¸€äº›è°ƒæ•´ï¼Œä½†å¤§å¤šæ•°éƒ½æ˜¯ç›¸ä¼¼çš„ã€‚æ­£å¦‚è®¨è®ºä¸­æ‰€è¿°ï¼Œé™ä½ LR åœ¨ DART çš„æƒ…å†µä¸‹å½“ç„¶æœ‰å¸®åŠ©ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜æ·»åŠ äº†meta featuresï¼ˆå¤§çº¦<em>0.0075 LR</em>ï¼‰ã€‚<br><strong>XGB (Max CV 0.7984 Priv. 0.80687)</strong> : XGB åŸºäº<a target="_blank" rel="noopener" href="https://www.kaggle.com/jiweiliu">@jiweiliu</a> å¼€æºçš„Notebook<br><strong>CAT (Max CV 0.7972)</strong> : Cat æˆ‘ä»¬ç”¨ä¸‹é¢çš„å‚æ•°åšäº†ä¸€äº›è°ƒæ•´ï¼Œå®ƒå¸®åŠ©äº†æˆ‘ä»¬å¾ˆå¤šã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CatBoostClassifier( random_state=CFG.seed,  </span><br><span class="line">                                bootstrap_type=<span class="string">&#x27;Bernoulli&#x27;</span>,</span><br><span class="line">                                task_type=<span class="string">&quot;GPU&quot;</span>,</span><br><span class="line">                                devices=<span class="string">&#x27;0:1&#x27;</span>,  </span><br><span class="line">                                use_best_model = <span class="literal">True</span>, </span><br><span class="line">                                iterations = <span class="number">11500</span>,</span><br><span class="line">                                num_leaves =<span class="number">64</span>,</span><br><span class="line">                                subsample = <span class="number">0.74</span>,</span><br><span class="line">                                grow_policy = <span class="string">&#x27;Lossguide&#x27;</span>, </span><br><span class="line">                                depth = <span class="number">9</span>) </span><br></pre></td></tr></table></figure>

<p>**Tabnet (MAX CV 0.793133 Private 0.80447)**ï¼šTabnet ä¸»è¦ä½¿ç”¨æ ‡å‡†å‚æ•°ï¼Œå¹¶ä¸”åœ¨meta featuresæ–¹é¢ç¡®å®æä¾›äº†æ›´å¥½çš„ç»“æœã€‚<br>**MLPï¼ˆPrivate 0.80109ï¼‰:**æˆ‘ä»¬å°è¯•äº†ä½¿ç”¨ cat åµŒå…¥å’Œä¸ä½¿ç”¨ tabnet çš„æ¨¡å‹ï¼ˆé€šè¿‡onehotencodingï¼‰:<strong>GaussianScaler</strong>æŠ€å·§æœ‰åŠ©äº NNæ¨¡å‹ å’Œ tabnetæ¨¡å‹ç»“æœ<br>**Tabtransformer (MAX CV 0.79507 Private 0.80480)**ï¼šè¿™ä¸»è¦åŸºäºå…¬å…±<a target="_blank" rel="noopener" href="https://www.kaggle.com/code/gauravbrills/tabtransformer-training">notebook</a>å’Œ<a target="_blank" rel="noopener" href="https://paperswithcode.com/method/tabtransformer">tabtransformer</a>è®ºæ–‡ã€‚æˆ‘ä»¬æ³¨æ„åˆ°è¿™æ¯”private LB ä¸­çš„ tabnet æ›´å¥½ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰é€‰æ‹©å®ƒï¼Œå› ä¸ºå®ƒåœ¨èæ¨¡ä¸­æ•ˆæœä¸ä½³ğŸ˜‘ã€‚ä¸‹é¢æ˜¯è¶…å‚æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">NUM_TRANSFORMER_BLOCKS = <span class="number">6</span>  <span class="comment"># Number of transformer blocks. 6 paper recommends</span></span><br><span class="line">NUM_HEADS = <span class="number">8</span>  <span class="comment"># Number of attention heads. 8 Heads paper recommends</span></span><br><span class="line">EMBEDDING_DIMS = <span class="number">16</span><span class="comment">#10  # Embedding dimensions of the categorical features. check 16,32</span></span><br><span class="line">DROPOUT_RATE = <span class="number">0.1</span></span><br><span class="line">MLP_HIDDEN_UNITS_FACTORS = [</span><br><span class="line">    <span class="number">4</span>,</span><br><span class="line">    <span class="number">2</span>,</span><br><span class="line">]  <span class="comment"># MLP hidden layer units, as factors of the number of inputs. =&gt;(4,2)</span></span><br><span class="line">NUM_MLP_BLOCKS = <span class="number">4</span>  <span class="comment"># Number of MLP blocks in the baseline model. Paper 4</span></span><br><span class="line">MLP_ACTIVATION = keras.activations.selu</span><br></pre></td></tr></table></figure>



<h2 id="æ¨¡å‹èåˆæŠ€å·§"><a href="#æ¨¡å‹èåˆæŠ€å·§" class="headerlink" title="æ¨¡å‹èåˆæŠ€å·§"></a>æ¨¡å‹èåˆæŠ€å·§</h2><p>æ‰€æœ‰æ¨¡å‹èåˆéƒ½æ˜¯æŒ‰logèåˆå®Œæˆçš„ï¼Œå› ä¸ºæˆ‘ä»¬å‘ç°å®ƒåœ¨é›†æˆ NN æ¨¡å‹æ—¶æ•ˆæœæ›´å¥½ã€‚æˆ‘ä»¬ä¹Ÿå°è¯•ä½¿ç”¨ rankingæ–¹æ³•è¿›è¡Œäº†é›†æˆï¼Œä½†æ˜¯åœ¨ä½¿ç”¨ NN é›†æˆæ—¶æ•ˆæœä¸ä½³ã€‚</p>
<p>æˆ‘ä»¬å°è¯•äº†ä¸€å †metaé›†æˆæŠ€æœ¯ï¼Œæœ‰å¾ˆå¤šæ¨¡å‹ã€‚æœ‰æ•ˆçš„æ˜¯Optuna weights å’Œ Elasticnet åœ¨ oof preds ä¹‹ä¸Šçš„<a target="_blank" rel="noopener" href="https://www.kaggle.com/code/cdeotte/forward-selection-oof-ensemble-0-942-private">forward selection</a>ï¼Œæˆ‘ä»¬ä¹Ÿå°è¯•äº†Stackingå’ŒVotingæŠ€æœ¯è¿›è¡Œæ¨¡å‹èåˆï¼Œä½†æ•ˆæœéƒ½ä¸å¥½ã€‚</p>
<h2 id="ä»€ä¹ˆä¸èµ·ä½œç”¨æˆ–æ²¡æœ‰ç”¨ï¼Ÿ"><a href="#ä»€ä¹ˆä¸èµ·ä½œç”¨æˆ–æ²¡æœ‰ç”¨ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆä¸èµ·ä½œç”¨æˆ–æ²¡æœ‰ç”¨ï¼Ÿ"></a>ä»€ä¹ˆä¸èµ·ä½œç”¨æˆ–æ²¡æœ‰ç”¨ï¼Ÿ</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.kaggle.com/code/gauravbrills/tabtransformer-training">Tabformer</a>ï¼šæˆ‘ä»¬æœ€ç»ˆä½¿ tabformer è¾¾åˆ° 0.795 cvï¼Œä½†åœ¨æœ€ç»ˆç§æ¦œæäº¤ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨è¯¥æ¨¡å‹ã€‚æˆ‘è®¤ä¸ºè¯¥æ¨¡å‹è¡¨ç°ä¼˜å¼‚ï¼Œä½†åœ¨æ¨¡å‹èåˆä¸­æ•ˆæœä¸ä½³ï¼Œå°½ç®¡åæ¥æˆ‘ä»¬å‘ç°è¿™æ˜¯æˆ‘ä»¬åœ¨ private LB å¾—åˆ†æœ€é«˜çš„NNæ¨¡å‹ ã€‚</li>
<li>TCN wavenetï¼šæˆ‘ä»¬å°è¯•åœ¨ tcn wavenet + MLP å®ç°ä¸­ä½¿ç”¨ 13 ä¸ªå®¢æˆ·å†å²åºåˆ—ï¼Œä½†ç»“æœåªæœ‰ 0.78 å·¦å³ï¼Œæ‰€ä»¥æˆ‘ä»¬æ”¾å¼ƒäº†è¿™ä¸ªæƒ³æ³•ã€‚</li>
<li>Saint å’Œwidedeep æ¨¡å‹ï¼šæˆ‘ä»¬è¿˜å°è¯•äº†wide deep package ä»¥å°è¯• <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2106.01342">SAINT</a> ï¼Œä½†æœªèƒ½æˆåŠŸã€‚å‚è€ƒ<a target="_blank" rel="noopener" href="https://github.com/jrzaurin/pytorch-widedeep">pytorch-widedeep</a></li>
<li>å¦‚ä¸Šæ‰€è¿°çš„ä¸€äº›ç‰¹å¾å’Œä¸€äº›åŸºäºæ’åˆ—æˆ–é›¶ç‰¹å¾é‡è¦æ€§è€Œè¢«ä¸¢å¼ƒçš„ç‰¹å¾ã€‚</li>
<li>æˆ‘ä»¬å°è¯•ä¸ºæˆ‘ä»¬æ‰€æœ‰çš„æœ‰ç”¨æ¨¡å‹åšå¤šç§å­é›†æˆã€‚ä¸åšæŒä½¿ç”¨ seed42ç›¸æ¯”ï¼Œè¿™åœ¨æŸç§ç¨‹åº¦ä¸Šå¹¶æ²¡æœ‰ç»™æˆ‘ä»¬å¸¦æ¥å¥½çš„ç»“æœã€‚</li>
<li>æœ€åä¹Ÿå°è¯•äº† Target ç¼–ç ï¼Œä½†æˆ‘ä»¬å‡ ä¹æ²¡æœ‰æ—¶é—´åœ¨ ensemble ä¸­æ£€æŸ¥è¿™äº›æ˜¯å¦æœ‰æ•ˆã€‚</li>
</ul>
<p>====================================================================================================================================================================================================================================================================================</p>
<p>å¦‚ä½•è¿è¡Œä»£ç </p>
<ol>
<li><p><strong>Install package</strong></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pip</span> install optuna eli<span class="number">5</span></span><br><span class="line"><span class="attribute">pip</span> install lightgbm==<span class="number">3</span>.<span class="number">3</span>.<span class="number">2</span></span><br><span class="line"><span class="attribute">pip</span> install xgboost==<span class="number">1</span>.<span class="number">6</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">pip</span> install modin</span><br><span class="line"><span class="attribute">pip</span> install catboost </span><br><span class="line"></span><br><span class="line"><span class="comment">##cudfå®‰è£…å¯æ ¹æ®å®é™…ç¯å¢ƒå®‰è£…</span></span><br><span class="line"><span class="comment">#https://rapids.ai/start.html#get-rapids</span></span><br><span class="line"><span class="attribute">conda</span> create -n rapids-<span class="number">22</span>.<span class="number">08</span> -c rapidsai -c nvidia -c conda-forge  \</span><br><span class="line">    <span class="attribute">cudf</span>=<span class="number">22</span>.<span class="number">08</span> python=<span class="number">3</span>.<span class="number">9</span> cudatoolkit=<span class="number">11</span>.<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><strong>æš‚æ—¶ä¸å¼€æº</strong></p>
</li>
<li><p><strong>download data</strong></p>
</li>
</ol>
<p>â€‹        ç”±äºæœ¬æ¬¡æ•°æ®é›†è¾ƒå¤§ï¼Œå»ºè®®ä½¿ç”¨kaggle apiä¸‹è½½æœ¬æ¬¡æ¯”èµ›æ•°æ®ã€‚(kaggle apiä½¿ç”¨<a target="_blank" rel="noopener" href="https://www.kaggle.com/docs/api">æ•™ç¨‹</a>)</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># https://www.kaggle.com/competitions/amex-<span class="keyword">default</span>-prediction/<span class="keyword">data</span></span><br><span class="line">kaggle competitions download -c amex-<span class="keyword">default</span>-prediction</span><br><span class="line"></span><br><span class="line"># https://www.kaggle.com/competitions/amex-<span class="keyword">default</span>-prediction/discussion/<span class="number">328514</span></span><br><span class="line">kaggle datasets download -d raddar/amex-<span class="keyword">data</span>-<span class="keyword">integer</span>-dtypes-parquet-<span class="keyword">format</span></span><br></pre></td></tr></table></figure>



<p><strong>å¦‚éœ€å°è¯•è¯¥æ¯”èµ›æ•°æ®ï¼Œéœ€è¦å†…å­˜ä¸ä½äº40Gçš„æœºå™¨</strong></p>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
        <div class="giscus"></div>
    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        <li>
            <a target="_blank" href="https://twitter.com/iconie_alloy">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-twitter"></i>
                            </span>
            </a>
        </li>
        
        
        <li>
            <a target="_blank" href="https://www.zhihu.com/people/ai-er-lan-xue-da">
                            <span class="fa-stack fa-lg">
                                 <i class="iconfont icon-zhihu"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank" href="http://weibo.com/3286578617">
                            <span class="fa-stack fa-lg">
                                  <i class="iconfont icon-weibo"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank" href="https://www.facebook.com/xiaotao.nie.5">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-facebook"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank"  href="https://github.com/albert51966">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank"  href="https://www.linkedin.com/in/å°æ¶›-è‚-80964aba">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-linkedin"></i>
                            </span>
            </a>
        </li>
        

    </ul>
    
    <p>
        <span>/</span>
        
        <span><a target="_blank" rel="noopener" href="https://www.10000h.top">10000H</a></span>
        <span>/</span>
        
        <span><a href="https://weihaocai.top">Albert&#39;s Page</a></span>
        <span>/</span>
        
        <span><a href="#">It helps SEO</a></span>
        <span>/</span>
        
        <span><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">æµ™ICPå¤‡16035324å·-1</a></span>
        <span>/</span>
        
    </p>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script src="https://giscus.app/client.js"
    data-repo="aircloud/hexo-aircloud-blog"
    data-repo-id="MDEwOlJlcG9zaXRvcnkxMjkwNDgyNjg="
    data-category="Announcements"
    data-category-id="DIC_kwDOB7EezM4COhKJ"
    data-mapping="title"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme="light"
    data-lang="zh-CN"
    crossorigin="anonymous"
    async>
</script>




</html>
